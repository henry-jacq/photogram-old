"/login"==window.location.pathname&&($("#icon-click").on("click",function(e){var t=$("#icon");t.hasClass("bi-eye-slash")?($("#pass").attr("type","text"),t.removeClass("bi-eye-slash"),t.addClass("bi-eye")):t.hasClass("bi-eye")&&($("#pass").attr("type","password"),t.removeClass("bi-eye"),t.addClass("bi-eye-slash"))}),$("#user, #pass, #rememberMe").on("keydown",function(e){if(13===e.keyCode)return e.preventDefault(),!1}),$(".user-login-form").on("submit",function(e){e.preventDefault(),$(".btn-login").attr("disabled",!0),$(".btn-login").html("Verifying credentials...");e=new FormData(this);$.ajax({type:"POST",url:"/api/auth/login",data:e,processData:!1,contentType:!1,success:function(e){$(".btn-login").html("Logging in..."),"Authenticated"==e.message&&(0!=e.redirect?location.replace(e.redirect):location.reload())},error:function(e,t){"error"==t&&(0===$(".alert.alert-danger.alert-dismissible.fade.show").length&&(t=$("<div>").addClass("alert alert-danger alert-dismissible fade show").html('<i class="bi bi-exclamation-circle me-2"></i><b class="fw-semibold">Invalid credentials!</b> Please try again.<button type="button" class="btn-close shadow-none" data-bs-dismiss="alert" aria-label="Close"></button>'),$(t).insertBefore("form")),$(".btn-login").attr("disabled",!1),$(".btn-login").html("Login now!"))}})})),"/register"==window.location.pathname&&($("#username, #password, #email").on("keydown",function(e){if(13===e.keyCode)return e.preventDefault(),!1}),$(".user-register-form").on("submit",function(e){e.preventDefault(),$(".btn-register").html("Checking credentials..."),$(".btn-register").attr("disabled",!0);e=new FormData(this);$.ajax({type:"POST",url:"/api/auth/register",data:e,processData:!1,contentType:!1,success:function(e){1==e.result&&$("section.container").html(`
                    <section class="container">
                        <div class="d-flex align-items-center justify-content-center min-vh-100">
                            <div class="py-3 col-sm-10 col-md-10 col-lg-8 col-xl-6">
                                <div class="bg-black bg-opacity-25 rounded-3 p-5 text-center border">
                                    <img src="/assets/brand/photogram-logo.png"
                                        alt="logo" class="img-fluid mx-auto d-block mb-4" width="63" height="63">
                                    <h3 class="display-6">Welcome to Photogram!</h3>
                                    <p class="lead mb-4">Your account has been created.</p>
                                    <a class="text-decoration-none" href="/login">
                                        <button class="btn btn-success hvr-icon-forward">Continue to login <i class="fa fa-arrow-right hvr-icon" aria-hidden="true"></i></button>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </section>`)},error:function(e,t){"error"==t&&(0===$(".alert.alert-danger.alert-dismissible.fade.show").length&&(t=$("<div>").addClass("alert alert-danger alert-dismissible fade show").html('<i class="bi bi-exclamation-circle me-2"></i><b class="fw-semibold">Failed to register!</b> Invalid credentials.<button type="button" class="btn-close shadow-none" data-bs-dismiss="alert" aria-label="Close"></button>'),$(t).insertBefore("form")),$(".btn-register").attr("disabled",!1),$(".btn-register").html("Register now!"))}})})),"/edit-profile"===window.location.pathname&&($(".user-form-data").on("submit",function(e){e.preventDefault();e=new FormData(this);let t=$(this),o=$(".btn-save-data");o.attr("disabled",!0),o.html('<div class="spinner-border spinner-border-sm me-1" role="status"><span class="visually-hidden">Loading...</span></div>Updating...'),$.ajax({url:"/api/users/profile/update",type:"POST",data:e,processData:!1,contentType:!1,success:function(e){"Updated"!=e.message&&"Created"!=e.message||(o.attr("disabled",!1),o.html("Update profile"),0===$(".alert.alert-primary.alert-dismissible.fade.show").length&&(e=$("<div>").addClass("alert alert-primary alert-dismissible fade show").html('<i class="bi bi-info-circle me-2"></i>Profile was successfully updated<button type="button" class="btn-close shadow-none" data-bs-dismiss="alert" aria-label="Close"></button>'),$(e).insertBefore(t)))},error:function(e){console.error("Error while updating:",e)}})}),$("#btnRemoveAvatar").on("click",function(){(d=new Dialog('<i class="bi bi-trash me-2"></i>Remove Avatar','After removing the avatar, the default user avatar generated from <a href="https://dicebear.com" class="text-decoration-none">dicebear.com</a> will be set as your default avatar.<br><br><b class="fw-semibold">Are you sure to continue?</b>')).setButtons([{name:"Cancel",class:"btn-secondary",onClick:function(e){$(e.data.modal).modal("hide")}},{name:"Yes, remove",class:"btn-danger",onClick:function(e){$.post("/api/users/profile/delete",function(e,t){1==e.message&&"success"==t?location.reload():console.error(e,t)}),$(e.data.modal).modal("hide")}}]),d.show()}));var masonry,grid=document.querySelector("#masonry-area");function setCookie(e,t,o){var a,s="; expires=";o&&((a=new Date).setTime(a.getTime()+24*o*60*60*1e3),s="; expires="+a.toUTCString()),document.cookie=e+"="+t+s+"; path=/; SameSite=Strict"}function cookieExists(e){for(var t=document.cookie.split(";"),o=0;o<t.length;o++)if(0===t[o].trim().indexOf(e+"="))return!0;return!1}function deleteCookie(e){expires="; expires=Thu, 01 Jan 1970 00:00:00 UTC",document.cookie=e+"="+expires+"; path=/; SameSite=Strict"}function likeBtn(e,t=null,o=!1){var a=e.find("i").attr("id"),a=$("#"+a),s=parseInt(e.find("span").text());1==t?a.hasClass("fa-heart-o")&&(a.removeClass("fa-heart-o"),a.addClass("fa-heart text-danger"),1==o)&&e.find("span").text(s+=1):0==t&&a.hasClass("fa-heart text-danger")&&0!=s&&(a.removeClass("fa-heart text-danger"),a.addClass("fa-heart-o"),e.find("span").text(s-1))}function likePost(o,a){void 0!==o&&void 0!==a&&$.post("/api/posts/like",{id:a},function(e,t){"success"==t?likeBtn(o,e.message,!0):console.error("Can't like the post ID: "+a)})}function showToast(e,t,o){e=new Toast(e,t,o,{}),e.show(),t=e.id,o=$("#"+t).find(".toast-header").find("small");e.showSec(o)}grid&&(masonry=new Masonry(grid,{percentPosition:!0}),imagesLoaded(grid).on("progress",function(){masonry.layout()})),"/login"==window.location.pathname&&(cookieExists("fingerprint")&&deleteCookie("fingerprint"),$("#rememberMe").on("click",function(){$("#rememberMe").is(":checked")?cookieExists("fingerprint")||fetch("https://openfpcdn.io/fingerprintjs/v3").then(e=>{e.ok&&import("https://openfpcdn.io/fingerprintjs/v3").then(e=>e.load()).then(e=>e.get()).then(e=>{setCookie("fingerprint",e.visitorId,1)})}):cookieExists("fingerprint")&&deleteCookie("fingerprint")})),$("img").on("contextmenu",function(){return!1}),$("img").mousedown(function(e){e.preventDefault()}),$("#postUploadButton").on("click",function(){var e=display_form_dialog();$("#"+e).on("shown.bs.modal",function(){var t;document.querySelector("#dzCreatePost")&&(Dropzone.autoDiscover=!1,t=new Dropzone("#dzCreatePost",{url:"/api/posts/create",paramName:"file",maxFiles:2,maxFilesize:5,parallelUploads:2,uploadMultiple:!0,acceptedFiles:".png,.jpeg,.jpg,.gif,.mp4,",autoProcessQueue:!1}),setInterval(()=>{0<t.files.length?$(".btn-reset, .btn-upload").prop("disabled",!1):$(".btn-reset, .btn-upload").prop("disabled",!0)},500),$(".btn-upload").on("click",function(e){e.preventDefault();$(this).html('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span> Posting'),t.processQueue(),t.on("queuecomplete",function(){location.reload()})}),$(".btn-reset").on("click",function(){$("[name=post_text]").val("");var e=$("[name=post_text]").val().length;$("#total_chars").text(e+"/240"),0<t.files.length&&t.removeAllFiles()})),$(document).ready(function(){const t=$("[name=post_text]"),o=$("#total_chars");t.on("input",function(){var e=t.val().length;o.removeClass("visually-hidden"),240<e&&(e=t.val().slice(0,240),t.val(e)),o.text(t.val().length+"/240")})})})}),$(".carousel, .post-card-image, .btn-like").hide(),$(window).on("load",function(){$(".card-text, .btn-group, .skeleton-header > .skeleton-text").removeClass("skeleton skeleton-text"),$("img").removeClass("skeleton-img")&&$(".carousel, .post-card-image, .btn-like").show(),void 0!==masonry&&masonry.layout()}),$(".btn-like, .btn-share").mouseover(function(){$(this).css("cursor","pointer")}),$(".btn-like").each(function(){let o=$(this),a=$(this).attr("data-id");$.post("/api/posts/like",{postID:a},function(e,t){"success"==t?likeBtn($(o),e.message,!1):console.error("Can't like the post ID: "+a)})}),$(".post-card-image, .carousel").dblclick(function(){likePost($(this).next().find(".btn-group").find(".btn-like"),$(this).attr("data-id"))}),$(".btn-like").on("click",function(){likePost($(this),$(this).attr("data-id"))}),$(".btn-delete").on("click",function(){post_id=$(this).parent().attr("data-id"),(d=new Dialog("Delete Post ?","You want to permanently delete this post?")).setButtons([{name:"Delete",class:"btn-danger",onClick:function(e){$.post("/api/posts/delete",{id:post_id},function(e,t){"success"==t?(sl=document.querySelector("#post-"+post_id),masonry.remove(sl),masonry.layout(),showToast("Photogram","Just Now","Your post was successfully deleted!")):showToast("Photogram","Just Now","Can't delete your post!")}),$(e.data.modal).modal("hide")}},{name:"Cancel",class:"btn-secondary",onClick:function(e){$(e.data.modal).modal("hide")}}]),d.show()}),$(".btn-copy-link").on("click",function(){var e=$(this).parents("header").next().find(".active").find("img").attr("src"),e=window.location.origin+(0!=this.getAttribute("value")?$(this).attr("value"):e);navigator.clipboard?(navigator.clipboard.writeText(e),showToast("Photogram","Just Now","Copied the post link to the clipboard!")):(console.error("Can't copy the post link!"),showToast("Photogram","Just Now","Can't copy the post link to the clipboard!"))}),$(".btn-download").on("click",function(){if(!this.hasAttribute("href")){var e=$(this).parents("header").next().find(".active").find("img").attr("src");let t=window.location.origin+(0!=this.getAttribute("value")?$(this).attr("value"):e);fetch(t).then(e=>e.blob()).then(e=>{e=URL.createObjectURL(e);this.setAttribute("href",e),this.setAttribute("download",t.replace(/^.*[\\\/]/,"")),this.click(),URL.revokeObjectURL(e),this.removeAttribute("href")}).catch(console.error)}}),"/profile"===window.location.pathname&&$.post("/api/posts/count?mode=user",function(e){$("#totalUserPosts").text(e.count)});
//# sourceMappingURL=app.min.js.map