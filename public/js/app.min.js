"/edit-profile"===window.location.pathname&&$(".user-form-data").on("submit",function(t){t.preventDefault();t=new FormData(this);let e=$(this),o=$(".btn-save-data");o.attr("disabled",!0),o.html('<div class="spinner-border spinner-border-sm me-1" role="status"><span class="visually-hidden">Loading...</span></div>Updating...'),$.ajax({url:"/api/users/profile/update",type:"POST",data:t,processData:!1,contentType:!1,success:function(t){"Updated"!=t.message&&"Created"!=t.message||(o.attr("disabled",!1),o.html("Update profile"),0===$(".alert.alert-primary.alert-dismissible.fade.show").length&&(t=$("<div>").addClass("alert alert-primary alert-dismissible fade show").html('<i class="bi bi-info-circle me-2"></i>Profile was successfully updated<button type="button" class="btn-close shadow-none" data-bs-dismiss="alert" aria-label="Close"></button>'),$(t).insertBefore(e)))},error:function(t){console.error("Error while updating:",t)}})});var grid=document.querySelector("#masonry-area"),masonry=new Masonry(grid,{percentPosition:!0});function likeBtn(t,e=null,o=!1){var s=t.find("i").attr("id"),s=$("#"+s),a=parseInt(t.find("span").text());1==e?s.hasClass("fa-heart-o")&&(s.removeClass("fa-heart-o"),s.addClass("fa-heart text-danger"),1==o)&&t.find("span").text(a+=1):0==e&&s.hasClass("fa-heart text-danger")&&0!=a&&(s.removeClass("fa-heart text-danger"),s.addClass("fa-heart-o"),t.find("span").text(a-1))}function likePost(o,s){void 0!==o&&void 0!==s&&$.post("/api/posts/like",{id:s},function(t,e){"success"==e?likeBtn(o,t.message,!0):console.error("Can't like the post ID: "+s)})}function showToast(t,e,o){t=new Toast(t,e,o,{}),t.show(),e=t.id,o=$("#"+e).find(".toast-header").find("small");t.showSec(o)}imagesLoaded(grid).on("progress",function(){masonry.layout()}),fetch("https://openfpcdn.io/fingerprintjs/v3").then(t=>{t.ok&&import("https://openfpcdn.io/fingerprintjs/v3").then(t=>t.load()).then(t=>t.get()).then(t=>{t=t.visitorId;$("#fingerprint")&&$("#fingerprint").val(t)})}),$("img").on("contextmenu",function(){return!1}),$("img").mousedown(function(t){t.preventDefault()}),$("#postUploadButton").on("click",function(){var t=display_form_dialog();$("#"+t).on("shown.bs.modal",function(){var e;document.querySelector("#dzCreatePost")&&(Dropzone.autoDiscover=!1,e=new Dropzone("#dzCreatePost",{url:"/api/posts/create",paramName:"file",maxFiles:2,maxFilesize:5,parallelUploads:2,uploadMultiple:!0,acceptedFiles:".png,.jpeg,.jpg,.gif,.mp4,",autoProcessQueue:!1}),setInterval(()=>{0<e.files.length?$(".btn-reset, .btn-upload").prop("disabled",!1):$(".btn-reset, .btn-upload").prop("disabled",!0)},500),$(".btn-upload").on("click",function(t){t.preventDefault();$(this).html('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span> Posting'),e.processQueue(),e.on("queuecomplete",function(){location.reload()})}),$(".btn-reset").on("click",function(){$("[name=post_text]").val("");var t=$("[name=post_text]").val().length;$("#total_chars").text(t+"/240"),0<e.files.length&&e.removeAllFiles()})),$(document).ready(function(){const e=$("[name=post_text]"),o=$("#total_chars");e.on("input",function(){var t=e.val().length;o.removeClass("visually-hidden"),240<t&&(t=e.val().slice(0,240),e.val(t)),o.text(e.val().length+"/240")})})})}),$("#icon-click").on("click",function(t){var e=$("#icon");e.hasClass("bi-eye-slash")?($("#pass").attr("type","text"),e.removeClass("bi-eye-slash"),e.addClass("bi-eye")):e.hasClass("bi-eye")&&($("#pass").attr("type","password"),e.removeClass("bi-eye"),e.addClass("bi-eye-slash"))}),$(".carousel, .post-card-image, .btn-like").hide(),$(window).on("load",function(){$(".card-text, .btn-group, .skeleton-header > .skeleton-text").removeClass("skeleton skeleton-text"),$("img").removeClass("skeleton-img")&&$(".carousel, .post-card-image, .btn-like").show(),masonry.layout()}),$(".btn-like, .btn-share").mouseover(function(){$(this).css("cursor","pointer")}),$(".btn-like").each(function(){let o=$(this),s=$(this).attr("data-id");$.post("/api/posts/like",{postID:s},function(t,e){"success"==e?likeBtn($(o),t.message,!1):console.error("Can't like the post ID: "+s)})}),$(".post-card-image, .carousel").dblclick(function(){likePost($(this).next().find(".btn-group").find(".btn-like"),$(this).attr("data-id"))}),$(".btn-like").on("click",function(){likePost($(this),$(this).attr("data-id"))}),$(".btn-delete").on("click",function(){post_id=$(this).parent().attr("data-id"),(d=new Dialog("Delete Post ?","You want to permanently delete this post?")).setButtons([{name:"Delete",class:"btn-danger",onClick:function(t){$.post("/api/posts/delete",{id:post_id},function(t,e){"success"==e?(sl=document.querySelector("#post-"+post_id),masonry.remove(sl),masonry.layout(),showToast("Photogram","Just Now","Your post was successfully deleted!")):showToast("Photogram","Just Now","Can't delete your post!")}),$(t.data.modal).modal("hide")}},{name:"Cancel",class:"btn-secondary",onClick:function(t){$(t.data.modal).modal("hide")}}]),d.show()}),$(".btn-copy-link").on("click",function(){var t=$(this).parents("header").next().find(".active").find("img").attr("src"),t=window.location.origin+(0!=this.getAttribute("value")?$(this).attr("value"):t);navigator.clipboard?(navigator.clipboard.writeText(t),showToast("Photogram","Just Now","Copied the post link to the clipboard!")):(console.error("Can't copy the post link!"),showToast("Photogram","Just Now","Can't copy the post link to the clipboard!"))}),$(".btn-download").on("click",function(){if(!this.hasAttribute("href")){var t=$(this).parents("header").next().find(".active").find("img").attr("src");let e=window.location.origin+(0!=this.getAttribute("value")?$(this).attr("value"):t);fetch(e).then(t=>t.blob()).then(t=>{t=URL.createObjectURL(t);this.setAttribute("href",t),this.setAttribute("download",e.replace(/^.*[\\\/]/,"")),this.click(),URL.revokeObjectURL(t),this.removeAttribute("href")}).catch(console.error)}}),"/profile"===window.location.pathname&&$.post("/api/posts/count?mode=user",function(t){$("#totalUserPosts").text(t.count)});
//# sourceMappingURL=app.min.js.map